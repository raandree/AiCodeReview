# Report Directory

## Purpose

This directory contains security reports generated by the PowerShell Security Scanner. Each report provides a comprehensive analysis of security findings for the scanned PowerShell modules.

## Generated Reports

### Report Types

The scanner generates Markdown-formatted reports:

- **Module-Specific Reports**: `<ModuleName>-SecurityReport.md`
  - Detailed findings for a single PowerShell module
  - Organized by severity level
  - Includes code snippets, remediation guidance, and CVSS scores

- **Executive Summaries** (optional): `Executive-Summary.md`
  - High-level overview across multiple modules
  - Risk assessment and prioritization
  - Consolidated statistics

## Report Structure

### Summary Section

Each report begins with a summary table:

```markdown
## Summary

| Severity | Count |
|----------|-------|
| Critical | 5     |
| High     | 12    |
| Medium   | 8     |
| Low      | 15    |
| Info     | 42    |
```

### Detailed Findings

Findings are organized by severity (Critical → High → Medium → Low → Info):

```markdown
### Critical Severity (5 findings)

---

**Rule**: Invoke-Expression Usage (PS001)
**Category**: CodeExecution
**File**: D:\Modules\MyModule\MyModule.psm1
**Line**: 42

**Code**:
```powershell
Invoke-Expression $userInput
```

**Description**: Detects use of Invoke-Expression which can execute arbitrary code from strings

**Remediation**: Replace Invoke-Expression with safer alternatives like & operator or dot-sourcing

**CVSS Score**: 9.8

```

## Understanding Severity Levels

### Critical (CVSS 9.0-10.0)
- **Immediate action required**
- High risk of exploitation
- Could lead to complete system compromise
- Examples: Code injection, hardcoded credentials

### High (CVSS 7.0-8.9)
- **Priority remediation**
- Significant security risk
- Could allow unauthorized access or data exposure
- Examples: Command injection, weak authentication

### Medium (CVSS 4.0-6.9)
- **Should be addressed**
- Moderate security concern
- May lead to information disclosure or limited access
- Examples: Insecure deserialization, weak cryptography

### Low (CVSS 0.1-3.9)
- **Best practice improvements**
- Minor security concern
- Limited exploitability
- Examples: Global variables, coding practices

### Info
- **Informational findings**
- Not directly exploitable
- Code quality or style recommendations
- Examples: Missing validation, documentation issues

## Using Reports

### Workflow

1. **Initial Review**
   - Open the generated report in a Markdown viewer
   - Review the summary table for severity distribution
   - Identify Critical and High findings first

2. **Prioritization**
   - Use CVSS scores to prioritize remediation efforts
   - Focus on findings with highest scores first
   - Consider business context and exposure

3. **Remediation**
   - Follow the remediation guidance for each finding
   - Implement fixes in your code
   - Re-run the scanner to verify fixes

4. **Tracking**
   - Archive reports to track security improvements over time
   - Compare before/after scans to measure progress
   - Use reports for compliance documentation

### Example Remediation Workflow

```powershell
# 1. Scan your module
.\scanner\Invoke-SecurityScan.ps1 -Path .\source\MyModule -OutputPath .\Report

# 2. Review the report
code .\Report\MyModule-SecurityReport.md

# 3. Fix critical issues in your code
# (Implement fixes based on remediation guidance)

# 4. Re-scan to verify
.\scanner\Invoke-SecurityScan.ps1 -Path .\source\MyModule -OutputPath .\Report

# 5. Compare results
code .\Report\MyModule-SecurityReport.md
```

## Report Formats

### Current Format: Markdown

- ✅ Human-readable
- ✅ Version control friendly
- ✅ Easy to share and review
- ✅ Convertible to HTML/PDF

### Future Formats (Planned)

- **JSON**: For programmatic processing
- **CSV**: For spreadsheet import
- **HTML**: For web viewing
- **SARIF**: For IDE integration

## Retention and Archiving

### Recommended Practices

1. **Version Control**
   - Consider committing reports for tracking
   - Use branches for before/after comparisons

2. **Archive Structure**

   ```
   Report/
   ├── 2024-11-24/
   │   ├── MyModule-SecurityReport.md
   │   └── Executive-Summary.md
   ├── 2024-12-01/
   │   └── MyModule-SecurityReport.md
   └── current/
       └── MyModule-SecurityReport.md
   ```

3. **Cleanup**
   - Archive old reports regularly
   - Keep latest reports in `Report/` directory
   - Maintain historical records for compliance

## Security Considerations

### Report Contents

Reports may contain:

- File paths and directory structures
- Code snippets from your modules
- Potentially sensitive variable names
- Architecture and design information

### Recommendations

- ✅ Treat reports as **confidential**
- ✅ Store in secure locations
- ✅ Limit access to authorized personnel
- ✅ Sanitize before sharing externally
- ❌ Do not commit to public repositories without review

## Troubleshooting

### No Reports Generated

**Possible Causes**:

- Scanner encountered errors
- No PowerShell files found in scan path
- Output directory permissions issue

**Solutions**:

```powershell
# Check scanner output for errors
.\scanner\Invoke-SecurityScan.ps1 -Path .\source\MyModule -OutputPath .\Report -Verbose

# Verify PowerShell files exist
Get-ChildItem .\source\MyModule -Include *.ps1,*.psm1,*.psd1 -Recurse

# Check directory permissions
Test-Path .\Report -PathType Container
```

### Report Appears Incomplete

**Possible Causes**:

- Parse errors in scanned files
- Scanner stopped prematurely

**Solutions**:

- Review scanner output for warnings
- Check for syntax errors in source files
- Ensure scanner completed without interruption

## Integration with CI/CD

### Automated Report Publishing

```yaml
# GitHub Actions example
- name: Publish Security Reports
  uses: actions/upload-artifact@v3
  with:
    name: security-reports
    path: Report/*.md
    retention-days: 90
```

### Report Quality Gates

```powershell
# Fail build if Critical findings exist
$report = Get-Content .\Report\MyModule-SecurityReport.md -Raw
if ($report -match 'Critical\s+\|\s+[1-9]') {
    throw "Critical security findings detected!"
}
```

## Additional Resources

- [Main README](../README.md) - Scanner usage guide
- [Scanner Documentation](../scanner/README.md) - Advanced options
- [Detection Rules](../scanner/rules/PowerShellContextRules.md) - Rule descriptions
- [Memory Bank](../memory-bank/README.md) - Project documentation

---

**Template Version**: 1.0.0  
**Purpose**: Security scan results and analysis workspace
